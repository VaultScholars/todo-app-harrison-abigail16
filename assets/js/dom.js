// dom.js
// In this file, students will write the functions that update the DOM.

// Useful DOM APIs to reference:
// - document.createElement: https://developer.mozilla.org/en-US/docs/Web/API/Document/createElement
// - Element.appendChild: https://developer.mozilla.org/en-US/docs/Web/API/Node/appendChild
// - document.querySelector: https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelector
// - HTMLInputElement: https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input
// - HTMLElement.focus(): https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/focus
// - Element.setAttribute(): https://developer.mozilla.org/en-US/docs/Web/API/Element/setAttribute
// - Element.classList: https://developer.mozilla.org/en-US/docs/Web/API/Element/classList

/*
EXPECTED HTML STRUCTURE FOR EACH TASK ITEM
------------------------------------------
The functions below should produce elements that match this structure:

<li class="task-item" data-id="TASK_ID_HERE">
  <div class="task-item-left">
    <input type="checkbox" class="task-checkbox" />

    <div class="task-main">
      <p class="task-title">TASK TITLE</p>

      <!-- Only show this if category or due date exist -->
      <p class="task-meta">CATEGORY â€¢ DUE_DATE</p>
    </div>
  </div>

  <div class="task-actions">
    <button type="button" class="task-delete-btn">Delete</button>
  </div>
</li>

Make sure your generated elements follow this structure
and use these same CSS classes.
*/


/*
EXPECTED OUTPUT OF renderTasks():
--------------------------------

<ul id="task-list">
  <!-- If there are tasks, this list will contain several <li> elements
       each generated by createTaskElement() -->

  <!-- If there are NO tasks:
       - The list should be empty
       - The "empty state" message should be visible -->
</ul>

<p id="empty-state">No tasks yet. Add your first task above!</p>
*/

// This function should:
// - Clear the current task list
// - Loop through the tasks array
// - Create an <li> for each task using createTaskElement()
// - Add each <li> to the <ul>
// - Show the empty state message when there are no tasks
// const taskList = document.getElementById("task-list");
//const emptyState = document.getElementById("empty-state");


function renderTasks(tasks, taskList, emptyState) {
  taskList.innerHTML = ""; 
  if (tasks.length === 0) {
    emptyState.style.display = "block";
    return; 
  } else {
    emptyState.style.display = "none";
  }

  for(let i = 0;  i < tasks.length; i++) {
    const taskHTML = createTaskElement(tasks[i]);
    taskList.innerHTML += taskHTML;
  }
  // TODO: Implement rendering logic
}

// This function should:
// - Create and return ONE <li> element following the structure above
// - Contain the checkbox, title, optional meta info, and delete button
// - Add the correct classes to each element
// - Make the checkbox checked if the task is completed
// - NOT add event listeners (app.js will handle that)
function createTaskElement(task) {
  let metaText = "";
  if (task.category) {
    metaText += task.category;
  }

  if (task.category && task.dueDate){
    metaText += " | ";
  }

  if (task.dueDate) {
    metaText += task.dueDate;
  }
  let metaHTML = "";
  if (metaText !== "") {
    metaHTML = `<p class="task-meta">${metaText}</p>`;
  }
  // TODO: Implement element creation logic
  const checked = task.completed ? "checked" : "";
  const completedClass = task.completed ? "completed" : "";

  return `
  <li class="task-item ${completedClass}" data-id ="${task.id}">
    <div class="task-item-left">
    
    <div class = "task-main">
      <p class="task-title">${task.title}</p>
      ${metaHTML}
    </div>
    </div>

    <div class = "task-actions">
      <button type="button" class = "task-delete-btn">Delete</button>
    </div>
  </li>
  `;
}



// This function should:
// - Reset the form
// - Put focus back on the task title input
function clearTaskForm(form) {
  form.reset();
  const titleInput = document.getElementById("task-title");
  if (titleInput) {
    titleInput.focus();
  }
  // TODO: Reset the form and focus the title input
}

